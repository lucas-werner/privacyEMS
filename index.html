<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EMS Ambulance | GDPR Implementation Report</title>
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6; /* A light grey background */
        }
        .gradient-text {
            background: linear-gradient(to right, #1e3a8a, #3b82f6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .card {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -2px rgb(0 0 0 / 0.1);
        }
    </style>
</head>
<body class="text-gray-800">

    <!-- Header Section -->
    <header class="bg-white shadow-md sticky top-0 z-40">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-3 flex justify-between items-center">
            <div class="flex items-center space-x-4">
                 <img src="data:image/jpeg;base64,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" alt="EMS Ambulance Logo" class="h-12" onerror="this.onerror=null; this.src='https://placehold.co/48x48/CCCCCC/FFFFFF?text=EMS';">
                <div>
                    <h1 class="text-xl sm:text-2xl font-bold text-gray-800">EMS Ambulance <span class="font-light">GDPR Implementation</span></h1>
                    <p class="text-sm text-gray-500">Report Date: <span id="currentDate"></span></p>
                </div>
            </div>
            <div class="flex items-center space-x-4">
                <img src="https://cdn.prod.website-files.com/6915c2db0622b3aa00c190fc/6915d16d64fd7bfac715d03f_logo.svg" alt="DPO Consultancy Logo" class="h-8 hidden sm:block" onerror="this.onerror=null; this.src='https://placehold.co/100x32/CCCCCC/FFFFFF?text=DPO';">
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8">
        
        <!-- Dashboard Summary -->
        <section id="dashboard" class="mb-10">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Overall Progress Chart -->
                <div class="card p-6 flex flex-col items-center justify-center lg:col-span-1">
                    <h2 class="text-xl font-bold mb-4 text-gray-700">Estimated Overall Progress</h2>
                    <div class="relative w-48 h-48 sm:w-56 sm:h-56">
                        <canvas id="progressChart"></canvas>
                        <div id="progressText" class="absolute inset-0 flex items-center justify-center text-4xl font-bold gradient-text"></div>
                    </div>
                </div>

                <!-- Key Metrics -->
                <div class="grid grid-cols-2 md:grid-cols-4 lg:col-span-2 gap-4">
                    <div class="card p-4 flex flex-col items-center justify-center text-center">
                        <span class="text-4xl font-bold text-gray-700" id="totalTasks"></span>
                        <p class="text-md text-gray-500 mt-1">Total Policies & Procedures</p>
                    </div>
                    <div class="card p-4 flex flex-col items-center justify-center text-center">
                        <span class="text-4xl font-bold text-green-600" id="completedTasks"></span>
                        <p class="text-md text-gray-500 mt-1">Completed</p>
                    </div>
                    <div class="card p-4 flex flex-col items-center justify-center text-center">
                        <span class="text-4xl font-bold text-yellow-600" id="inProgressTasks"></span>
                        <p class="text-md text-gray-500 mt-1">In Progress</p>
                    </div>
                    <div class="card p-4 flex flex-col items-center justify-center text-center">
                        <span class="text-4xl font-bold text-blue-600" id="awaitingSignatureTasks"></span>
                        <p class="text-md text-gray-500 mt-1">Awaiting Signature</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- PMA Breakdown -->
        <section id="pma-breakdown">
            <div class="flex justify-between items-center mb-6 border-b-2 border-blue-200 pb-2">
                <h2 class="text-3xl font-bold text-gray-800">Privacy Management Activities (PMAs)</h2>
                <div class="flex items-center space-x-2">
                    <button id="openModalBtn" class="inline-flex items-center px-4 py-2 bg-gray-600 text-white text-sm font-medium rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors">
                        Recommendations & Next Steps
                    </button>
                    <a href="https://docs.google.com/spreadsheets/d/1nOHa54mo4RTAbq81KlUhvR73j3SDrHQz6gqysI25qQo/edit?usp=drive_web&ouid=107151025512254714374" target="_blank" rel="noopener noreferrer" class="inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
                        </svg>
                        View Project Tracker
                    </a>
                </div>
            </div>
            <div id="pma-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- PMA Cards will be injected here by JavaScript -->
            </div>
        </section>
    </main>

    <!-- Recommendations Modal -->
    <div id="recommendationsModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-3xl m-4">
            <div class="p-6 border-b flex justify-between items-center">
                <h3 class="text-2xl font-bold text-gray-800">Recommendations & Next Steps</h3>
                <button id="closeModalBtn" class="text-gray-400 hover:text-gray-600">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>
            <div class="p-6 max-h-[70vh] overflow-y-auto">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <!-- Recommendations -->
                    <div>
                        <h4 class="text-xl font-bold text-gray-800 mb-4">Recommendations</h4>
                        <div class="space-y-4 prose max-w-none">
                            <div>
                                <h5 class="font-bold">Appoint a Data Protection Officer (DPO)</h5>
                                <p>Given the large-scale processing of health data, appointing a DPO is a legal requirement under GDPR to oversee the data protection strategy.</p>
                            </div>
                             <div>
                                <h5 class="font-bold">Establish a Privacy Officer (PO) Role</h5>
                                <p>To support the DPO, a PO should handle daily operational privacy tasks, allowing the DPO to focus on strategic compliance and monitoring.</p>
                            </div>
                        </div>
                    </div>
                    <!-- Next Steps -->
                    <div>
                        <h4 class="text-xl font-bold text-gray-800 mb-4">Next Steps</h4>
                        <ul class="space-y-3 list-disc list-inside">
                            <li>Make the Extranet compliant with GDPR standards.</li>
                            <li>Perform Data Protection Impact Assessments (DPIAs) for high-risk processing activities.</li>
                            <li>Roll out mandatory GDPR training and awareness programs for all staff.</li>
                            <li>Finalize and obtain signatures for all remaining policies and procedures.</li>
                            <li>Ensure the conclusion of the implementation phase and maintain ongoing compliance through engagement with an external PO and DPO.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <footer class="mt-12 bg-white border-t">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-6 text-center">
            <p class="text-gray-500 text-sm">&copy; <span id="currentYear"></span> EMS Ambulance - Confidential Internal Report</p>
        </div>
    </footer>

    <script>
        // --- DATA ---
        const projectData = [
            { pma: "PMA 3 - Maintain Records of Processing Activities", task: "RoPA Questionnaire Automation", status: "Completed", owner: "Lucas Noronha", endDate: "2025-08-12", notes: "PMA 03 update on Records of Processing Activities." },
            { pma: "PMA 3 - Maintain Records of Processing Activities", task: "Record of Processing Activities", status: "Ongoing", owner: "Lucas Noronha", endDate: "2025-08-12", notes: "Record of Processing Activities - EMS Ambulance." },
            { pma: "PMA 4 - Privacy Policy & Document Management", task: "Privacy Statement Website (external)", status: "Completed", owner: "Lucas Noronha", endDate: "2025-08-19", notes: "External privacy statement updated." },
            { pma: "PMA 4 - Privacy Policy & Document Management", task: "Cookie Notice (website)", status: "Completed", owner: "Hank Melse", endDate: "2025-08-19", notes: "Marketing agency to update cookie policy list." },
            { pma: "PMA 4 - Privacy Policy & Document Management", task: "Privacy Statement (internal)", status: "To Sign", owner: "Lucas Noronha", endDate: "2025-08-26", notes: "Awaiting Dee Khettry four-eyes review." },
            { pma: "PMA 2 - Maintain Governance", task: "Privacy Governance Policy", status: "To Sign", owner: "Lucas Noronha", endDate: "2025-08-26", notes: "Helma Ligtenbarg supporting structure review." },
            { pma: "PMA 9 - Data Breach Management Program", task: "Data Breach Procedure", status: "To Sign", owner: "Lucas Noronha", endDate: "2025-08-26", notes: "Data breach standard operating procedure." },
            { pma: "PMA 9 - Data Breach Management Program", task: "Data Breach Register", status: "Completed", owner: "Lucas Noronha", endDate: "2025-08-26", notes: "EMS Ambulance register updated." },
            { pma: "PMA 7 - Complaints & DSR Management", task: "Data Subject Rights Procedure", status: "To Sign", owner: "Hank Melse", endDate: "2025-09-02", notes: "Lucas to review before sign-off." },
            { pma: "PMA 7 - Complaints & DSR Management", task: "DSR Request Log Register", status: "Completed", owner: "Hank Melse", endDate: "2025-09-02", notes: "DSR Register EN v1.0." },
            { pma: "PMA 5 - Education (training & awareness)", task: "GDPR Awareness training", status: "Blocked", owner: "Lucas Noronha", endDate: null, notes: "Training on data breaches pending scheduling." },
            { pma: "PMA 6 - Manage Third Party Risks", task: "Vendor List: DPA", status: "Completed", owner: "Hank Melse", endDate: "2025-09-09", notes: "Medical email confirmation received." },
            { pma: "PMA 6 - Manage Third Party Risks", task: "DPA Due Diligence Checklist", status: "Completed", owner: "Lucas Noronha", endDate: "2025-09-09", notes: "DPA checklist v1.0 issued." },
            { pma: "PMA 4 - Privacy Policy & Document Management", task: "Data Retention Schedule", status: "To Sign", owner: "Lucas Noronha", endDate: "2025-09-16", notes: "Document ready for final review." },
            { pma: "PMA 6 - Manage Third Party Risks", task: "Intragroup Sharing Agreement", status: "To Sign", owner: "Lucas Noronha", endDate: "2025-09-23", notes: "Confirm legal entities for signature." },
            { pma: "PMA 8 - Monitor New Operational Practices", task: "Policy for Data Protection Impact Assessments", status: "To Sign", owner: "Lucas Noronha", endDate: "2025-09-23", notes: "DPIA procedure ready for sign-off." },
            { pma: "PMA 8 - Monitor New Operational Practices", task: "CCTV Pre-DPIA", status: "Completed", owner: "Lucas Noronha", endDate: "2025-09-30", notes: "Checklist EMS_23092025.pdf." },
            { pma: "PMA 8 - Monitor New Operational Practices", task: "AI Preliminary Risk Assessment", status: "Completed", owner: "Lucas Noronha", endDate: "2025-09-30", notes: "EMS preliminary AI assessment." },
            { pma: "PMA 6 - Manage Third Party Risks", task: "Sign DPA SquareMedia", status: "Blocked", owner: "Lucas Noronha", endDate: "2025-10-10", notes: "Awaiting feedback from Score Media legal team." },
            { pma: "PMA 4 - Privacy Policy & Document Management", task: "Standardize Layout/Name of Policies", status: "Completed", owner: "Lucas Noronha", endDate: "2025-10-07", notes: "" },
            { pma: "PMA 2 - Maintain Governance", task: "Determine the requirement for EMS to appoint a DPO", status: "Completed", owner: "Lucas Noronha", endDate: "2025-10-07", notes: "Recommendation documented." },
            { pma: "PMA 10 - Track External Criteria", task: "Final Report: achievements & gaps", status: "Ongoing", owner: "Lucas Noronha", endDate: "2025-10-14", notes: "" },
        ];
        
        const pmaList = [
            "PMA 1 - Assess Data Handling Practices", 
            "PMA 2 - Maintain Governance", 
            "PMA 3 - Maintain Records of Processing Activities",
            "PMA 4 - Privacy Policy & Document Management", 
            "PMA 5 - Education (training & awareness)", 
            "PMA 6 - Manage Third Party Risks",
            "PMA 7 - Complaints & DSR Management", 
            "PMA 8 - Monitor New Operational Practices", 
            "PMA 9 - Data Breach Management Program", 
            "PMA 10 - Track External Criteria"
        ];
        
        // --- SCRIPT LOGIC ---
        document.addEventListener('DOMContentLoaded', function () {
            const today = new Date(); 
            
            const currentDateEl = document.getElementById('currentDate');
            if (currentDateEl) {
                currentDateEl.textContent = today.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
            }
            document.getElementById('currentYear').textContent = today.getFullYear();

            // --- Dashboard Metrics Calculation ---
            const policyKeywords = ['Policy', 'Procedure', 'Statement', 'Schedule', 'Agreement', 'Register', 'Checklist', 'Notice'];
            const policyTasks = projectData.filter(t => 
                policyKeywords.some(keyword => t.task.toLowerCase().includes(keyword.toLowerCase()))
            );

            const completedStatuses = ['completed'];
            const totalTasks = policyTasks.length;
            const completedTasks = policyTasks.filter(t => completedStatuses.includes(t.status.toLowerCase())).length;
            const inProgressTasks = policyTasks.filter(t => !completedStatuses.includes(t.status.toLowerCase())).length;
            const awaitingSignatureTasks = policyTasks.filter(t => t.status.toLowerCase() === 'to sign').length;
            const overallProgress = totalTasks > 0 ? Math.round((completedTasks / totalTasks) * 100) : 0;

            document.getElementById('progressText').textContent = `${overallProgress}%`;
            document.getElementById('totalTasks').textContent = totalTasks;
            document.getElementById('completedTasks').textContent = completedTasks;
            document.getElementById('inProgressTasks').textContent = inProgressTasks;
            document.getElementById('awaitingSignatureTasks').textContent = awaitingSignatureTasks;
            
            renderProgressChart(overallProgress);
            renderPmaCards(today);

            // --- Modal Logic ---
            const modal = document.getElementById('recommendationsModal');
            const openBtn = document.getElementById('openModalBtn');
            const closeBtn = document.getElementById('closeModalBtn');

            openBtn.onclick = function() {
                modal.classList.remove('hidden');
            }
            closeBtn.onclick = function() {
                modal.classList.add('hidden');
            }
            window.onclick = function(event) {
                if (event.target == modal) {
                    modal.classList.add('hidden');
                }
            }
        });

        function renderProgressChart(progress) {
            const ctx = document.getElementById('progressChart').getContext('2d');
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    datasets: [{
                        data: [progress, 100 - progress],
                        backgroundColor: ['#1e3a8a', '#e5e7eb'],
                        borderWidth: 0,
                        cutout: '75%',
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: { tooltip: { enabled: false }, legend: { display: false } },
                    animation: { animateScale: true, animateRotate: true }
                }
            });
        }

        function renderPmaCards(today) {
            const pmaGrid = document.getElementById('pma-grid');
            pmaGrid.innerHTML = ''; // Clear existing cards
             const completedStatuses = ['completed'];
            pmaList.forEach(pmaTitle => {
                const pmaTasks = projectData.filter(task => task.pma === pmaTitle);
                const pmaCard = document.createElement('div');
                pmaCard.className = 'card flex flex-col p-5';

                const pmaCompleted = pmaTasks.filter(t => completedStatuses.includes(t.status.toLowerCase())).length;
                const pmaTotal = pmaTasks.length;
                
                let tasksHtml = '<div class="text-gray-500 italic mt-4 text-sm">No tasks defined for this PMA.</div>';
                if (pmaTotal > 0) {
                    tasksHtml = pmaTasks.map(task => {
                        const isOverdue = !completedStatuses.includes(task.status.toLowerCase()) && task.status.toLowerCase() !== 'ongoing' && task.status.toLowerCase() !== 'to sign' && task.endDate && new Date(task.endDate) < today;
                        const statusInfo = getStatusInfo(task.status, isOverdue);

                        return `
                            <div class="flex items-start justify-between py-2 border-b border-gray-100 last:border-b-0">
                                <div class="flex-grow pr-2">
                                    <p class="font-medium text-gray-700">${task.task}</p>
                                </div>
                                <span class="${statusInfo.classes} text-xs font-semibold inline-flex items-center px-2.5 py-0.5 rounded-full">
                                    ${statusInfo.icon}
                                    ${isOverdue ? 'Overdue' : statusInfo.text}
                                </span>
                            </div>`;
                    }).join('');
                }

                pmaCard.innerHTML = `
                    <div class="flex-grow">
                        <h3 class="text-lg font-bold text-gray-800">${pmaTitle.split(' - ')[1]}</h3>
                        <p class="text-xs text-gray-400 font-medium uppercase">${pmaTitle.split(' - ')[0]}</p>
                        <div class="mt-4 space-y-2">${tasksHtml}</div>
                    </div>`;
                pmaGrid.appendChild(pmaCard);
            });
        }

        function getStatusInfo(status, isOverdue) {
            if (isOverdue) {
                return { text: 'Overdue', classes: 'bg-red-100 text-red-800', icon: `<svg class="w-4 h-4 mr-1.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.414-1.414L11 9.586V6z" clip-rule="evenodd"></path></svg>` };
            }
            switch (status.toLowerCase()) {
                case 'completed': return { text: 'Completed', classes: 'bg-green-100 text-green-800', icon: `<svg class="w-4 h-4 mr-1.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>` };
                case 'in progress': return { text: 'In Progress', classes: 'bg-yellow-100 text-yellow-800', icon: `<svg class="w-4 h-4 mr-1.5 animate-spin" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>` };
                case 'ongoing': return { text: 'Ongoing', classes: 'bg-yellow-100 text-yellow-800', icon: `<svg class="w-4 h-4 mr-1.5 animate-spin" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>` };
                case 'review': return { text: 'Review', classes: 'bg-indigo-100 text-indigo-800', icon: `<svg class="w-4 h-4 mr-1.5" fill="currentColor" viewBox="0 0 20 20"><path d="M10 12.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path><path fill-rule="evenodd" d="M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.022 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z" clip-rule="evenodd"></path></svg>` };
                case 'to sign': return { text: 'Awaiting Signature', classes: 'bg-blue-100 text-blue-800', icon: `<svg class="w-4 h-4 mr-1.5" fill="currentColor" viewBox="0 0 20 20"><path d="M3 4a2 2 0 012-2h6a2 2 0 011.732 1H15a2 2 0 012 2v1h-2V5H5v10h4v2H5a2 2 0 01-2-2V4z"></path><path d="M15 12h3l-4 7-2-3-3 3 4-7h2z"></path></svg>` };
                case 'blocked': return { text: 'Blocked', classes: 'bg-orange-100 text-orange-800', icon: `<svg class="w-4 h-4 mr-1.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 1a9 9 0 100 18 9 9 0 000-18zM8.707 5.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 5.293z" clip-rule="evenodd" /></svg>` };
                case 'not started': return { text: 'Not Started', classes: 'bg-gray-200 text-gray-800', icon: '' };
                default: return { text: status, classes: 'bg-gray-200 text-gray-800', icon:'' };
            }
        }
    </script>
</body>
</html>

