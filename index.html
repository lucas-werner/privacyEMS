<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EMS Ambulance | GDPR Implementation Report - Q3 2025</title>
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6; /* A light grey background */
        }
        .gradient-text {
            background: linear-gradient(to right, #1e3a8a, #3b82f6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .card {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -2px rgb(0 0 0 / 0.1);
        }
    </style>
</head>
<body class="text-gray-800">

    <!-- Header Section -->
    <header class="bg-white shadow-md sticky top-0 z-40">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-3 flex justify-between items-center">
            <div class="flex items-center space-x-4">
                 <img src="https://th.bing.com/th/id/OIP.4BY6YwaOernTX0JKqMxV3AAAAA?w=129&h=150&c=7&r=0&o=7&pid=1.7&rm=3" alt="EMS Ambulance Logo" class="h-12">
                 <div>
                    <h1 class="text-xl sm:text-2xl font-bold text-gray-800">EMS Ambulance <span class="font-light">GDPR Implementation</span></h1>
                    <p class="text-sm text-gray-500">Report Date: <span id="currentDate"></span></p>
                 </div>
            </div>
            <div class="flex items-center space-x-4">
                <img src="https://www.dpoconsultancy.com/wp-content/uploads/2024/03/DPO_logo.svg" alt="DPO Consultancy Logo" class="h-8 hidden sm:block">
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8">
        
        <!-- Dashboard Summary -->
        <section id="dashboard" class="mb-10">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Overall Progress Chart -->
                <div class="card p-6 flex flex-col items-center justify-center lg:col-span-1">
                    <h2 class="text-xl font-bold mb-4 text-gray-700">Overall Progress</h2>
                    <div class="relative w-48 h-48 sm:w-56 sm:h-56">
                        <canvas id="progressChart"></canvas>
                        <div id="progressText" class="absolute inset-0 flex items-center justify-center text-4xl font-bold gradient-text"></div>
                    </div>
                </div>

                <!-- Key Metrics -->
                <div class="grid grid-cols-2 md:grid-cols-4 lg:col-span-2 gap-4">
                    <div class="card p-4 flex flex-col items-center justify-center text-center">
                        <span class="text-4xl font-bold text-gray-700" id="totalTasks"></span>
                        <p class="text-md text-gray-500 mt-1">Total Tasks</p>
                    </div>
                    <div class="card p-4 flex flex-col items-center justify-center text-center">
                        <span class="text-4xl font-bold text-green-600" id="completedTasks"></span>
                        <p class="text-md text-gray-500 mt-1">Completed</p>
                    </div>
                    <div class="card p-4 flex flex-col items-center justify-center text-center">
                        <span class="text-4xl font-bold text-yellow-600" id="inProgressTasks"></span>
                        <p class="text-md text-gray-500 mt-1">In Progress</p>
                    </div>
                    <div class="card p-4 flex flex-col items-center justify-center text-center">
                        <span class="text-4xl font-bold text-red-600" id="overdueTasks"></span>
                        <p class="text-md text-gray-500 mt-1">Overdue</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- PMA Breakdown -->
        <section id="pma-breakdown">
            <div class="flex justify-between items-center mb-6 border-b-2 border-blue-200 pb-2">
                <h2 class="text-3xl font-bold text-gray-800">Privacy Management Activities (PMAs)</h2>
                <a href="https://docs.google.com/spreadsheets/d/1nOHa54mo4RTAbq81KlUhvR73j3SDrHQz6gqysI25qQo/edit?usp=drive_web&ouid=107151025512254714374" target="_blank" rel="noopener noreferrer" class="inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
                    </svg>
                    View Project Tracker
                </a>
            </div>
            <div id="pma-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- PMA Cards will be injected here by JavaScript -->
            </div>
        </section>
    </main>
    
    <footer class="mt-12 bg-white border-t">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-6 text-center">
            <p class="text-gray-500 text-sm">&copy; <span id="currentYear"></span> EMS Ambulance - Confidential Internal Report</p>
        </div>
    </footer>

    <script>
        // --- DATA ---
        const projectData = [
            { pma: "PMA 3 - Maintain Records of Processing Activities", task: "RoPA Questionnaire Automation", status: "Completed", owner: "Lucas Noronha", endDate: "2025-08-12", notes: "PMA 03 update on Records of Processing Activities." },
            { pma: "PMA 3 - Maintain Records of Processing Activities", task: "Record of Processing Activities", status: "Completed", owner: "Lucas Noronha", endDate: "2025-08-12", notes: "Record of Processing Activities - EMS Ambulance." },
            { pma: "PMA 4 - Privacy Policy & Document Management", task: "Privacy Statement Website (external)", status: "Completed", owner: "Lucas Noronha", endDate: "2025-08-19", notes: "External privacy statement updated." },
            { pma: "PMA 4 - Privacy Policy & Document Management", task: "Cookie Notice (website)", status: "Completed", owner: "Hank Melse", endDate: "2025-08-19", notes: "Marketing agency to update cookie policy list." },
            { pma: "PMA 4 - Privacy Policy & Document Management", task: "Privacy Statement (internal)", status: "To Sign", owner: "Lucas Noronha", endDate: "2025-08-26", notes: "Awaiting Dee Khettry four-eyes review." },
            { pma: "PMA 2 - Maintain Governance", task: "Privacy Governance Policy", status: "To Sign", owner: "Lucas Noronha", endDate: "2025-08-26", notes: "Helma Ligtenbarg supporting structure review." },
            { pma: "PMA 9 - Data Breach Management Program", task: "Data Breach Procedure", status: "To Sign", owner: "Lucas Noronha", endDate: "2025-08-26", notes: "Data breach standard operating procedure." },
            { pma: "PMA 9 - Data Breach Management Program", task: "Data Breach Register", status: "Completed", owner: "Lucas Noronha", endDate: "2025-08-26", notes: "EMS Ambulance register updated." },
            { pma: "PMA 7 - Complaints & DSR Management", task: "Data Subject Rights Procedure", status: "To Sign", owner: "Hank Melse", endDate: "2025-09-02", notes: "Lucas to review before sign-off." },
            { pma: "PMA 7 - Complaints & DSR Management", task: "DSR Request Log Register", status: "Completed", owner: "Hank Melse", endDate: "2025-09-02", notes: "DSR Register EN v1.0." },
            { pma: "PMA 5 - Education (training & awareness)", task: "GDPR Awareness training", status: "Blocked", owner: "Lucas Noronha", endDate: null, notes: "Training on data breaches pending scheduling." },
            { pma: "PMA 6 - Manage Third Party Risks", task: "Vendor List: DPA", status: "Completed", owner: "Hank Melse", endDate: "2025-09-09", notes: "Medical email confirmation received." },
            { pma: "PMA 6 - Manage Third Party Risks", task: "DPA Due Diligence Checklist", status: "Completed", owner: "Lucas Noronha", endDate: "2025-09-09", notes: "DPA checklist v1.0 issued." },
            { pma: "PMA 4 - Privacy Policy & Document Management", task: "Data Retention Schedule", status: "To Sign", owner: "Lucas Noronha", endDate: "2025-09-16", notes: "Document ready for final review." },
            { pma: "PMA 6 - Manage Third Party Risks", task: "Intragroup Sharing Agreement", status: "To Sign", owner: "Lucas Noronha", endDate: "2025-09-23", notes: "Confirm legal entities for signature." },
            { pma: "PMA 8 - Monitor New Operational Practices", task: "Policy for Data Protection Impact Assessments", status: "To Sign", owner: "Lucas Noronha", endDate: "2025-09-23", notes: "DPIA procedure ready for sign-off." },
            { pma: "PMA 8 - Monitor New Operational Practices", task: "CCTV Pre-DPIA", status: "Completed", owner: "Lucas Noronha", endDate: "2025-09-30", notes: "Checklist EMS_23092025.pdf." },
            { pma: "PMA 8 - Monitor New Operational Practices", task: "AI Preliminary Risk Assessment", status: "Completed", owner: "Lucas Noronha", endDate: "2025-09-30", notes: "EMS preliminary AI assessment." },
            { pma: "PMA 6 - Manage Third Party Risks", task: "Sign DPA SquareMedia", status: "Blocked", owner: "Lucas Noronha", endDate: "2025-10-10", notes: "Awaiting feedback from Score Media legal team." },
            { pma: "PMA 4 - Privacy Policy & Document Management", task: "Standardize Layout/Name of Policies", status: "Completed", owner: "Lucas Noronha", endDate: "2025-10-07", notes: "" },
            { pma: "PMA 2 - Maintain Governance", task: "Determine the requirement for EMS to appoint a DPO", status: "Completed", owner: "Lucas Noronha", endDate: "2025-10-07", notes: "Recommendation documented." },
            { pma: "PMA 10 - Track External Criteria", task: "Final Report: achievements & gaps", status: "Not Started", owner: "Lucas Noronha", endDate: "2025-10-14", notes: "" },
        ];
        
        const pmaList = [
            "PMA 1 - Assess Data Handling Practices", 
            "PMA 2 - Maintain Governance", 
            "PMA 3 - Maintain Records of Processing Activities",
            "PMA 4 - Privacy Policy & Document Management", 
            "PMA 5 - Education (training & awareness)", 
            "PMA 6 - Manage Third Party Risks",
            "PMA 7 - Complaints & DSR Management", 
            "PMA 8 - Monitor New Operational Practices", 
            "PMA 9 - Data Breach Management Program", 
            "PMA 10 - Track External Criteria"
        ];
        
        // --- SCRIPT LOGIC ---
        document.addEventListener('DOMContentLoaded', function () {
            const today = new Date('2025-09-11T12:00:00'); 
            
            const currentDateEl = document.getElementById('currentDate');
            if (currentDateEl) {
                currentDateEl.textContent = today.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
            }
            document.getElementById('currentYear').textContent = today.getFullYear();

            // A task is considered "complete" when its status is marked as 'Completed'.
            const completedStatuses = ['completed'];
            const completedTasks = projectData.filter(t => completedStatuses.includes(t.status.toLowerCase())).length;
            const inProgressTasks = projectData.filter(t => !completedStatuses.includes(t.status.toLowerCase())).length;
            // A task is "overdue" if it's not completed AND its end date is in the past.
            const overdueTasks = projectData.filter(t => !completedStatuses.includes(t.status.toLowerCase()) && t.endDate && new Date(t.endDate) < today).length;
            const totalTasks = projectData.length;
            const overallProgress = totalTasks > 0 ? Math.round((completedTasks / totalTasks) * 100) : 0;

            document.getElementById('progressText').textContent = `${overallProgress}%`;
            document.getElementById('totalTasks').textContent = totalTasks;
            document.getElementById('completedTasks').textContent = completedTasks;
            document.getElementById('inProgressTasks').textContent = inProgressTasks;
            document.getElementById('overdueTasks').textContent = overdueTasks;
            
            renderProgressChart(overallProgress);
            renderPmaCards(today);
        });

        function renderProgressChart(progress) {
            const ctx = document.getElementById('progressChart').getContext('2d');
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    datasets: [{
                        data: [progress, 100 - progress],
                        backgroundColor: ['#1e3a8a', '#e5e7eb'],
                        borderWidth: 0,
                        cutout: '75%',
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: { tooltip: { enabled: false }, legend: { display: false } },
                    animation: { animateScale: true, animateRotate: true }
                }
            });
        }

        function renderPmaCards(today) {
            const pmaGrid = document.getElementById('pma-grid');
            pmaGrid.innerHTML = ''; // Clear existing cards
            pmaList.forEach(pmaTitle => {
                const pmaTasks = projectData.filter(task => task.pma === pmaTitle);
                const pmaCard = document.createElement('div');
                pmaCard.className = 'card flex flex-col p-5';

                const pmaCompleted = pmaTasks.filter(t => completedStatuses.includes(t.status.toLowerCase())).length;
                const pmaTotal = pmaTasks.length;
                const pmaProgress = pmaTotal > 0 ? Math.round((pmaCompleted / pmaTotal) * 100) : 100;

                let tasksHtml = '<div class="text-gray-500 italic mt-4 text-sm">No tasks defined for this PMA.</div>';
                if (pmaTotal > 0) {
                    tasksHtml = pmaTasks.map(task => {
                        const isOverdue = !completedStatuses.includes(task.status.toLowerCase()) && task.endDate && new Date(task.endDate) < today;
                        const statusInfo = getStatusInfo(task.status, isOverdue);
                        const dueDateText = formatDate(task.endDate, today);

                        return `
                            <div class="flex items-start justify-between py-2 border-b border-gray-100 last:border-b-0">
                                <div class="flex-grow pr-2">
                                    <p class="font-medium text-gray-700">${task.task}</p>
                                    <div class="mt-1 text-xs text-gray-500 flex flex-wrap gap-x-2 gap-y-1">
                                        ${task.owner ? `<span class="font-medium text-gray-600">Owner: ${task.owner}</span>` : ''}
                                        <span>Due: ${dueDateText}</span>
                                    </div>
                                    ${task.notes ? `<p class="mt-1 text-xs text-gray-500">${task.notes}</p>` : ''}
                                </div>
                                <span class="${statusInfo.classes} text-xs font-semibold inline-flex items-center px-2.5 py-0.5 rounded-full">
                                    ${statusInfo.icon}
                                    ${isOverdue ? 'Overdue' : statusInfo.text}
                                </span>
                            </div>`;
                    }).join('');
                }

                pmaCard.innerHTML = `
                    <div class="flex-grow">
                        <h3 class="text-lg font-bold text-gray-800">${pmaTitle.split(' - ')[1]}</h3>
                        <p class="text-xs text-gray-400 font-medium uppercase">${pmaTitle.split(' - ')[0]}</p>
                        <div class="mt-3">
                            <div class="flex justify-between mb-1">
                                <span class="text-sm font-medium text-blue-700">Progress</span>
                                <span class="text-sm font-medium text-blue-700">${pmaProgress}%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2.5">
                                <div class="bg-blue-600 h-2.5 rounded-full" style="width: ${pmaProgress}%"></div>
                            </div>
                        </div>
                        <div class="mt-4 space-y-2">${tasksHtml}</div>
                    </div>`;
                pmaGrid.appendChild(pmaCard);
            });
        }

        function formatDate(dateString, today) {
            if (!dateString) {
                return 'TBD';
            }
            const date = new Date(dateString);
            if (isNaN(date.getTime())) {
                return 'TBD';
            }
            const options = { month: 'short', day: 'numeric' };
            if (date.getFullYear() !== today.getFullYear()) {
                options.year = 'numeric';
            }
            return date.toLocaleDateString('en-US', options);
        }

        function getStatusInfo(status, isOverdue) {
            if (isOverdue) {
                return { text: 'Overdue', classes: 'bg-red-100 text-red-800', icon: `<svg class="w-4 h-4 mr-1.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.414-1.414L11 9.586V6z" clip-rule="evenodd"></path></svg>` };
            }
            switch (status.toLowerCase()) {
                case 'completed': return { text: 'Completed', classes: 'bg-green-100 text-green-800', icon: `<svg class="w-4 h-4 mr-1.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>` };
                case 'in progress': return { text: 'In Progress', classes: 'bg-yellow-100 text-yellow-800', icon: `<svg class="w-4 h-4 mr-1.5 animate-spin" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>` };
                case 'review': return { text: 'Review', classes: 'bg-indigo-100 text-indigo-800', icon: `<svg class="w-4 h-4 mr-1.5" fill="currentColor" viewBox="0 0 20 20"><path d="M10 12.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5z"></path><path fill-rule="evenodd" d="M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.022 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z" clip-rule="evenodd"></path></svg>` };
                case 'to sign': return { text: 'Awaiting Signature', classes: 'bg-blue-100 text-blue-800', icon: `<svg class="w-4 h-4 mr-1.5" fill="currentColor" viewBox="0 0 20 20"><path d="M3 4a2 2 0 012-2h6a2 2 0 011.732 1H15a2 2 0 012 2v1h-2V5H5v10h4v2H5a2 2 0 01-2-2V4z"></path><path d="M15 12h3l-4 7-2-3-3 3 4-7h2z"></path></svg>` };
                case 'blocked': return { text: 'Blocked', classes: 'bg-orange-100 text-orange-800', icon: `<svg class="w-4 h-4 mr-1.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 1a9 9 0 100 18 9 9 0 000-18zM8.707 5.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 5.293z" clip-rule="evenodd" /></svg>` };
                case 'not started': return { text: 'Not Started', classes: 'bg-gray-200 text-gray-800', icon: '' };
                default: return { text: status, classes: 'bg-gray-200 text-gray-800', icon:'' };
            }
        }
    </script>
</body>
</html>


